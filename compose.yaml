version: '3.8'

services:
  postgres:
    image: postgres:${POSTGRES_TAG}
    ports:
      - 5435:5432
    environment:
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_DB: ${POSTGRES_DB}
    volumes:
      - postgre_docker_vol:/var/lib/postgresql/data
    networks:
      - kube_news_net
  
#Exetends
  web:
    extends: 
      file: ./kube-news.compose.yaml
      service: kube_news

#Foi para outra classe
#  kube_news:
#    image: joaomarcos200/kube-news:${KUBE_NEW_TAG}
#    build: 
#      context: ./src
#      dockerfile: Dockerfile
#    ports:
#      - 8080:8080
#    networks:
#      - kube_news_net
#    depends_on:
#      - postgres
#    environment:
#      DB_DATABASE: ${POSTGRES_DB}
#      DB_USERNAME: ${POSTGRES_USER}
#      DB_PASSWORD: ${POSTGRES_PASSWORD}
#      DB_HOST: postgres 
#      DB_PORT: 5432 

volumes:
  postgre_docker_vol:

networks:
  kube_news_net:
    driver: bridge